@startuml

start
:Execute Job;
:Get catalog metadata;
if (Get access-token) then (allowed)
  if () then (read)
    :Read data;
    stop
  else (write)
    :Write data;
    :Update catalog;
    :Update lineage;
    stop
  endif
else (denied)
  stop
endif

@enduml
